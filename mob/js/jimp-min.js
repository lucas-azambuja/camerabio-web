/**
 * Minified by jsDelivr using UglifyJS v3.0.24.
 * Original file: /npm/jimp-min@0.2.32/index.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
function log(t){clear(),chars=t.length}function clear(){}function noop(){}function isNodePattern(t){if(void 0===t)return!1;if("function"!=typeof t)throw new Error("Callback must be a function");return!0}function throwError(t,i){if("string"==typeof t&&(t=new Error(t)),"function"==typeof i)return i.call(this,t);throw t}function Jimp(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],i=arguments[1],a=arguments[2];if("number"==typeof arguments[2]){this._background=arguments[2];a=arguments[3]}if(void 0===a&&(a=noop),"function"!=typeof a)return throwError.call(this,"cb must be a function",a);this.bitmap={data:new Buffer(t*i*4),width:t,height:i};for(var r=0;r<this.bitmap.data.length;r+=4)this.bitmap.data.writeUInt32BE(this._background,r);a.call(this,null,this)}else if("object"==typeof arguments[0]&&arguments[0].constructor==Jimp){var e=arguments[0];if(void 0===(a=arguments[1])&&(a=noop),"function"!=typeof a)return throwError.call(this,"cb must be a function",a);var h=new Buffer(e.bitmap.data.length);e.scan(0,0,e.bitmap.width,e.bitmap.height,function(t,i,a){var r=e.bitmap.data.readUInt32BE(a,!0);h.writeUInt32BE(r,a,!0)}),this.bitmap={data:h,width:e.bitmap.width,height:e.bitmap.height},this._quality=e._quality,this._deflateLevel=e._deflateLevel,this._deflateStrategy=e._deflateStrategy,this._filterType=e._filterType,this._rgba=e._rgba,this._background=e._background,a.call(this,null,this)}else if(URLRegEx({exact:!0}).test(arguments[0])){var n=arguments[0];if(void 0===(a=arguments[1])&&(a=noop),"function"!=typeof a)return throwError.call(this,"cb must be a function",a);s=this;Request(n,function(t,i,r){if(t)return throwError.call(s,t,a);if("object"!=typeof r||!Buffer.isBuffer(r))return throwError.call(s,"Could not load Buffer from URL <"+n+"> (HTTP: "+i.statusCode+")",a);var e=getMIMEFromBuffer(r);if("string"!=typeof e)return throwError.call(s,"Could not find MIME for Buffer <"+n+"> (HTTP: "+i.statusCode+")",a);parseBitmap.call(s,r,e,a)})}else if("string"==typeof arguments[0]){var o=arguments[0];if(void 0===(a=arguments[1])&&(a=noop),"function"!=typeof a)return throwError.call(this,"cb must be a function",a);var s=this;getMIMEFromPath(o,function(t,i){FS.readFile(o,function(t,r){if(t)return throwError.call(s,t,a);parseBitmap.call(s,r,i,a)})})}else{if("object"!=typeof arguments[0])return throwError.call(this,"No matching constructor overloading was found. Please see the docs for how to call the Jimp constructor.",a);var p=arguments[0],m=getMIMEFromBuffer(p),a=arguments[1];if(!Buffer.isBuffer(p))return throwError.call(this,"data must be a Buffer",a);if("string"!=typeof m)return throwError.call(this,"mime must be a string",a);if("function"!=typeof a)return throwError.call(this,"cb must be a function",a);parseBitmap.call(this,p,m,a)}}function getMIMEFromBuffer(t,i){var a=FileType(t);return a?a.mime:i?MIME.lookup(i):null}function getMIMEFromPath(t,i){ReadChunk(t,0,262,function(t,a){if(!t){var r=FileType(a);return i&&i(null,r&&r.mime||"")}i(null,"")})}function parseBitmap(t,i,a){var r=this;switch(this._originalMime=i.toLowerCase(),this.getMIME()){case Jimp.MIME_PNG:(new PNG).parse(t,function(t,i){return t?throwError.call(r,t,a):(r.bitmap={data:new Buffer(i.data),width:i.width,height:i.height},a.call(r,null,r))});break;case Jimp.MIME_JPEG:try{return this.bitmap=JPEG.decode(t),exifRotate(this,t),a.call(this,null,this)}catch(t){return a.call(this,t,this)}case Jimp.MIME_BMP:return this.bitmap=BMP.decode(t),a.call(this,null,this);default:return throwError.call(this,"Unsupported MIME type: "+i,a)}}function exifRotate(t,i){var a;try{a=EXIFParser.create(i).parse()}catch(t){return}if(a&&a.tags&&a.tags.Orientation)switch(a.tags.Orientation){case 1:break;case 2:t.mirror(!0,!1);break;case 3:t.rotate(180);break;case 4:t.mirror(!1,!0);break;case 5:t.mirror(!0,!1).rotate(270);break;case 6:t.rotate(90);break;case 7:t.mirror(!0,!1).rotate(90);break;case 8:t.rotate(270)}}function histogram(){var t={r:new Array(256).fill(0),g:new Array(256).fill(0),b:new Array(256).fill(0)};return this.scan(0,0,this.bitmap.width,this.bitmap.height,function(i,a,r){t.r[this.bitmap.data[r+0]]++,t.g[this.bitmap.data[r+1]]++,t.b[this.bitmap.data[r+2]]++}),t}function simpleRotate(t){for(var i=Math.round(t/90)%4;i<0;)i+=4;for(;i>0;){for(var a=new Buffer(this.bitmap.data.length),r=0,e=0;e<this.bitmap.width;e++)for(var h=this.bitmap.height-1;h>=0;h--){var n=this.bitmap.width*h+e<<2,o=this.bitmap.data.readUInt32BE(n,!0);a.writeUInt32BE(o,r,!0),r+=4}this.bitmap.data=new Buffer(a);var s=this.bitmap.width;this.bitmap.width=this.bitmap.height,this.bitmap.height=s,i--}}function advancedRotate(t,i){function a(t,i){return function(a,r){return{x:a+t,y:r+i}}}var r,e,h=t%360*Math.PI/180,n=Math.cos(h),o=Math.sin(h);if(1==i||"string"==typeof i){r=Math.round(Math.abs(this.bitmap.width*n)+Math.abs(this.bitmap.height*o)),e=Math.round(Math.abs(this.bitmap.width*o)+Math.abs(this.bitmap.height*n));var s=this.clone();this.scan(0,0,this.bitmap.width,this.bitmap.height,function(t,i,a){this.bitmap.data.writeUInt32BE(this._background,a)});var p=Math.max(r,e,this.bitmap.width,this.bitmap.height);this.resize(p,p,i),this.blit(s,this.bitmap.width/2-s.bitmap.width/2,this.bitmap.height/2-s.bitmap.height/2)}for(var m=new Buffer(this.bitmap.data.length),u=a(-this.bitmap.width/2,-this.bitmap.height/2),l=a(this.bitmap.width/2,this.bitmap.height/2),b=0;b<this.bitmap.height;b++)for(y=0;y<this.bitmap.width;y++){var f=u(y,this.bitmap.height-b),c=l(n*f.x-o*f.y,n*f.y+o*f.x);if(c.x>=0&&c.x<this.bitmap.width&&c.y>=0&&c.y<this.bitmap.height){var d=(this.bitmap.width*(this.bitmap.height-c.y-1|0)+c.x|0)<<2,g=this.bitmap.data.readUInt32BE(d,!0),w=this.bitmap.width*b+y<<2;m.writeUInt32BE(g,w)}else{w=this.bitmap.width*b+y<<2;m.writeUInt32BE(this._background,w)}}if(this.bitmap.data=m,1==i||"string"==typeof i){var y=this.bitmap.width/2-r/2,b=this.bitmap.height/2-e/2;this.crop(y,b,r,e)}}function compositeBitmapOverBackground(t){return new Jimp(t.bitmap.width,t.bitmap.height,t._background).composite(t,0,0).bitmap}function loadPages(t,i){var a=i.map(function(i){return Jimp.read(t+"/"+i)});return Promise.all(a)}function printText(t,i,a,r){for(var e=0;e<r.length;e++)t.chars[r[e]]&&(drawCharacter(this,t,i,a,t.chars[r[e]]),i+=(t.kernings[r[e]]&&t.kernings[r[e]][r[e+1]]?t.kernings[r[e]][r[e+1]]:0)+(t.chars[r[e]].xadvance||0))}function drawCharacter(t,i,a,r,e){if(e.width>0&&e.height>0){var h=i.pages[e.page].clone().crop(e.x,e.y,e.width,e.height);return t.composite(h,a+e.xoffset,r+e.yoffset)}return t}function measureText(t,i){for(var a=0,r=0;r<i.length;r++)t.chars[i[r]]&&(a+=t.chars[i[r]].xoffset+(t.kernings[i[r]]&&t.kernings[i[r]][i[r+1]]?t.kernings[i[r]][i[r+1]]:0)+(t.chars[i[r]].xadvance||0));return a}var PNG=require("pngjs").PNG,JPEG=require("jpeg-js"),BMP=require("bmp-js"),MIME=require("mime"),TinyColor=require("tinycolor2"),Resize=require("./resize.js"),Resize2=require("./resize2.js"),StreamToBuffer=require("stream-to-buffer"),ReadChunk=require("read-chunk"),FileType=require("file-type"),PixelMatch=require("pixelmatch"),EXIFParser=require("exif-parser"),ImagePHash=require("./phash.js"),BigNumber=require("bignumber.js"),URLRegEx=require("url-regex"),BMFont=require("load-bmfont"),Path=require("path"),chars=0;Jimp.read=function(t,i){return new Promise(function(a,r){if(i=i||function(t,i){t?r(t):a(i)},"string"!=typeof t&&("object"!=typeof t||!Buffer.isBuffer(t)))return throwError.call(this,"src must be a string or a Buffer",i);new Jimp(t,i)})},Jimp.AUTO=-1,Jimp.MIME_PNG="image/png",Jimp.MIME_JPEG="image/jpeg",Jimp.MIME_BMP="image/bmp",Jimp.PNG_FILTER_AUTO=-1,Jimp.PNG_FILTER_NONE=0,Jimp.PNG_FILTER_SUB=1,Jimp.PNG_FILTER_UP=2,Jimp.PNG_FILTER_AVERAGE=3,Jimp.PNG_FILTER_PAETH=4,Jimp.RESIZE_NEAREST_NEIGHBOR="nearestNeighbor",Jimp.RESIZE_BILINEAR="bilinearInterpolation",Jimp.RESIZE_BICUBIC="bicubicInterpolation",Jimp.RESIZE_HERMITE="hermiteInterpolation",Jimp.RESIZE_BEZIER="bezierInterpolation",Jimp.HORIZONTAL_ALIGN_LEFT=1,Jimp.HORIZONTAL_ALIGN_CENTER=2,Jimp.HORIZONTAL_ALIGN_RIGHT=4,Jimp.VERTICAL_ALIGN_TOP=8,Jimp.VERTICAL_ALIGN_MIDDLE=16,Jimp.VERTICAL_ALIGN_BOTTOM=32,Jimp.EDGE_EXTEND=1,Jimp.EDGE_WRAP=2,Jimp.EDGE_CROP=3,Jimp.rgbaToInt=function(t,i,a,r,e){if("number"!=typeof t||"number"!=typeof i||"number"!=typeof a||"number"!=typeof r)return throwError.call(this,"r, g, b and a must be numbers",e);if(t<0||t>255)return throwError.call(this,"r must be between 0 and 255",e);if((i<0||i>255)&&throwError.call(this,"g must be between 0 and 255",e),a<0||a>255)return throwError.call(this,"b must be between 0 and 255",e);if(r<0||r>255)return throwError.call(this,"a must be between 0 and 255",e);var h=t*Math.pow(256,3)+i*Math.pow(256,2)+a*Math.pow(256,1)+r*Math.pow(256,0);return isNodePattern(e)?e.call(this,null,h):h},Jimp.intToRGBA=function(t,i){if("number"!=typeof t)return throwError.call(this,"i must be a number",i);var a={};return a.r=Math.floor(t/Math.pow(256,3)),a.g=Math.floor((t-a.r*Math.pow(256,3))/Math.pow(256,2)),a.b=Math.floor((t-a.r*Math.pow(256,3)-a.g*Math.pow(256,2))/Math.pow(256,1)),a.a=Math.floor((t-a.r*Math.pow(256,3)-a.g*Math.pow(256,2)-a.b*Math.pow(256,1))/Math.pow(256,0)),isNodePattern(i)?i.call(this,null,a):a},Jimp.limit255=function(t){return t=Math.max(t,0),t=Math.min(t,255)},Jimp.diff=function(t,i,a){if("object"!=typeof t||t.constructor!=Jimp||"object"!=typeof i||i.constructor!=Jimp)return throwError.call(this,"img1 and img2 must be an Jimp images");if(t.bitmap.width!=i.bitmap.width||t.bitmap.height!=i.bitmap.height)switch(t.bitmap.width*t.bitmap.height>i.bitmap.width*i.bitmap.height){case!0:t=t.clone().resize(i.bitmap.width,i.bitmap.height);break;default:i=i.clone().resize(t.bitmap.width,t.bitmap.height)}if("number"!=typeof(a=a||.1)||a<0||a>1)return throwError.call(this,"threshold must be a number between 0 and 1");var r=new Jimp(t.bitmap.width,t.bitmap.height,4294967295);return{percent:PixelMatch(t.bitmap.data,i.bitmap.data,r.bitmap.data,r.bitmap.width,r.bitmap.height,{threshold:a})/(r.bitmap.width*r.bitmap.height),image:r}},Jimp.distance=function(t,i){var a=new ImagePHash,r=a.getHash(t),e=a.getHash(i);return a.distance(r,e)},Jimp.prototype.bitmap={data:null,width:null,height:null},Jimp.prototype._quality=100,Jimp.prototype._deflateLevel=9,Jimp.prototype._deflateStrategy=3,Jimp.prototype._filterType=Jimp.PNG_FILTER_AUTO,Jimp.prototype._rgba=!0,Jimp.prototype._background=0,Jimp.prototype._originalMime=Jimp.MIME_PNG,Jimp.prototype.clone=function(t){var i=new Jimp(this);return isNodePattern(t)?t.call(i,null,i):i},Jimp.prototype.quality=function(t,i){return"number"!=typeof t?throwError.call(this,"n must be a number",i):t<0||t>100?throwError.call(this,"n must be a number 0 - 100",i):(this._quality=Math.round(t),isNodePattern(i)?i.call(this,null,this):this)},Jimp.prototype.deflateLevel=function(t,i){return"number"!=typeof t?throwError.call(this,"l must be a number",i):t<0||t>9?throwError.call(this,"l must be a number 0 - 9",i):(this._deflateLevel=Math.round(t),isNodePattern(i)?i.call(this,null,this):this)},Jimp.prototype.deflateStrategy=function(t,i){return"number"!=typeof t?throwError.call(this,"s must be a number",i):t<0||t>3?throwError.call(this,"s must be a number 0 - 3",i):(this._deflateStrategy=Math.round(t),isNodePattern(i)?i.call(this,null,this):this)},Jimp.prototype.filterType=function(t,i){return"number"!=typeof t?throwError.call(this,"n must be a number",i):t<-1||t>4?throwError.call(this,"n must be -1 (auto) or a number 0 - 4",i):(this._filterType=Math.round(t),isNodePattern(i)?i.call(this,null,this):this)},Jimp.prototype.rgba=function(t,i){return"boolean"!=typeof t?throwError.call(this,"bool must be a boolean, true for RGBA or false for RGB",i):(this._rgba=t,isNodePattern(i)?i.call(this,null,this):this)},Jimp.prototype.background=function(t,i){return"number"!=typeof t?throwError.call(this,"hex must be a hexadecimal rgba value",i):(this._background=t,isNodePattern(i)?i.call(this,null,this):this)},Jimp.prototype.scan=function(t,i,a,r,e,h){if("number"!=typeof t||"number"!=typeof i)return throwError.call(this,"x and y must be numbers",h);if("number"!=typeof a||"number"!=typeof r)return throwError.call(this,"w and h must be numbers",h);if("function"!=typeof e)return throwError.call(this,"f must be a function",h);t=Math.round(t),i=Math.round(i),a=Math.round(a),r=Math.round(r);for(var n=i;n<i+r;n++)for(var o=t;o<t+a;o++){var s=this.bitmap.width*n+o<<2;e.call(this,o,n,s)}return isNodePattern(h)?h.call(this,null,this):this},Jimp.prototype.getMIME=function(){return this._originalMime||Jimp.MIME_PNG},Jimp.prototype.getExtension=function(){var t=this.getMIME();return MIME.extension(t)},Jimp.prototype.getPixelIndex=function(t,i,a,r){var e,h;if("function"==typeof a&&void 0===r&&(r=a,a=null),a||(a=Jimp.EDGE_EXTEND),"number"!=typeof t||"number"!=typeof i)return throwError.call(this,"x and y must be numbers",r);e=t=Math.round(t),h=i=Math.round(i),(a=Jimp.EDGE_EXTEND)&&(t<0&&(e=0),t>=this.bitmap.width&&(e=this.bitmap.width-1),i<0&&(h=0),i>=this.bitmap.height&&(h=this.bitmap.height-1)),(a=Jimp.EDGE_WRAP)&&(t<0&&(e=this.bitmap.width+t),t>=this.bitmap.width&&(e=t%this.bitmap.width),i<0&&(e=this.bitmap.height+i),i>=this.bitmap.height&&(h=i%this.bitmap.height));var n=this.bitmap.width*h+e<<2;return(e<0||e>=this.bitmap.width)&&(n=-1),(h<0||h>=this.bitmap.height)&&(n=-1),isNodePattern(r)?r.call(this,null,n):n},Jimp.prototype.getPixelColor=Jimp.prototype.getPixelColour=function(t,i,a){if("number"!=typeof t||"number"!=typeof i)return throwError.call(this,"x and y must be numbers",a);t=Math.round(t),i=Math.round(i);var r=this.getPixelIndex(t,i),e=this.bitmap.data.readUInt32BE(r);return isNodePattern(a)?a.call(this,null,e):e},Jimp.prototype.setPixelColor=Jimp.prototype.setPixelColour=function(t,i,a,r){if("number"!=typeof t||"number"!=typeof i||"number"!=typeof a)return throwError.call(this,"hex, x and y must be numbers",r);i=Math.round(i),a=Math.round(a);var e=this.getPixelIndex(i,a);return this.bitmap.data.writeUInt32BE(t,e,!0),isNodePattern(r)?r.call(this,null,this):this};for(var maxHashLength=[],i=0;i<65;i++){var l=i>1?new BigNumber(Array(65).join("1"),2).toString(i):NaN;maxHashLength.push(l.length)}Jimp.prototype.hash=function(t,i){if("function"==typeof(t=t||64)&&(i=t,t=64),"number"!=typeof t)return throwError.call(this,"base must be a number",i);if(t<2||t>64)return throwError.call(this,"base must be a number between 2 and 64",i);var a=(new ImagePHash).getHash(this);for(a=new BigNumber(a,2).toString(t);a.length<maxHashLength[t];)a="0"+a;return isNodePattern(i)?i.call(this,null,a):a},Jimp.prototype.crop=function(t,i,a,r,e){if("number"!=typeof t||"number"!=typeof i)return throwError.call(this,"x and y must be numbers",e);if("number"!=typeof a||"number"!=typeof r)return throwError.call(this,"w and h must be numbers",e);t=Math.round(t),i=Math.round(i),a=Math.round(a),r=Math.round(r);var h=new Buffer(this.bitmap.data.length),n=0;return this.scan(t,i,a,r,function(t,i,a){var r=this.bitmap.data.readUInt32BE(a,!0);h.writeUInt32BE(r,n,!0),n+=4}),this.bitmap.data=new Buffer(h),this.bitmap.width=a,this.bitmap.height=r,isNodePattern(e)?e.call(this,null,this):this},Jimp.prototype.autocrop=function(){for(var t,i=this.bitmap.width,a=this.bitmap.height,r=2e-4,e=!0,h=0,n=arguments.length;h<n;h++)"number"==typeof arguments[h]&&(r=arguments[h]),"boolean"==typeof arguments[h]&&(e=arguments[h]),"function"==typeof arguments[h]&&(t=arguments[h]);var o=this.getPixelColor(0,0),s=0,p=0,m=0,u=0,l=Jimp.intToRGBA(o);t:for(d=0;d<a-1;d++){for(c=0;c<i;c++){var b=this.getPixelColor(c,d),f=Jimp.intToRGBA(b);if((g=Math.abs(Math.max(l.r-f.r^2,l.r-f.r-l.a+f.a^2)+Math.max(l.g-f.g^2,l.g-f.g-l.a+f.a^2)+Math.max(l.b-f.b^2,l.b-f.b-l.a+f.a^2))/196608)>r)break t}s++}t:for(c=0;c<i-1;c++){for(d=0+s;d<a;d++){var b=this.getPixelColor(c,d),f=Jimp.intToRGBA(b);if((g=Math.abs(Math.max(l.r-f.r^2,l.r-f.r-l.a+f.a^2)+Math.max(l.g-f.g^2,l.g-f.g-l.a+f.a^2)+Math.max(l.b-f.b^2,l.b-f.b-l.a+f.a^2))/196608)>r)break t}p++}o=this.getPixelColor(i-1,a-1);t:for(d=a-1;d>=0+s+1;d--){for(c=i-p-1;c>=0;c--){var b=this.getPixelColor(c,d),f=Jimp.intToRGBA(b);if((g=Math.abs(Math.max(l.r-f.r^2,l.r-f.r-l.a+f.a^2)+Math.max(l.g-f.g^2,l.g-f.g-l.a+f.a^2)+Math.max(l.b-f.b^2,l.b-f.b-l.a+f.a^2))/196608)>r)break t}m++}t:for(var c=i-1;c>=0+p+1;c--){for(var d=a-1;d>=0+s;d--){var b=this.getPixelColor(c,d),f=Jimp.intToRGBA(b),g=Math.abs(Math.max(l.r-f.r^2,l.r-f.r-l.a+f.a^2)+Math.max(l.g-f.g^2,l.g-f.g-l.a+f.a^2)+Math.max(l.b-f.b^2,l.b-f.b-l.a+f.a^2))/196608;if(g>r)break t}u++}var w=i-(u+p),y=a-(m+s);return(e?0!==p&&0!==s&&0!==u&&0!==m:0!==p||0!==s||0!==u||0!==m)&&this.crop(p,s,w,y),isNodePattern(t)?t.call(this,null,this):this},Jimp.prototype.blit=function(t,i,a,r,e,h,n,o){if("object"!=typeof t||t.constructor!=Jimp)return throwError.call(this,"The source must be a Jimp image",o);if("number"!=typeof i||"number"!=typeof a)return throwError.call(this,"x and y must be numbers",o);if("function"==typeof r)o=r,r=0,e=0,h=t.bitmap.width,n=t.bitmap.height;else{if(typeof r!=typeof e||typeof e!=typeof h||typeof h!=typeof n)return throwError.call(this,"srcx, srcy, srcw, srch must be numbers",o);r=r||0,e=e||0,h=h||t.bitmap.width,n=n||t.bitmap.height}i=Math.round(i),a=Math.round(a),r=Math.round(r),e=Math.round(e),h=Math.round(h),n=Math.round(n);var s=this;return t.scan(r,e,h,n,function(t,h,n){var o=s.getPixelIndex(i+t-r,a+h-e);s.bitmap.data[o]=this.bitmap.data[n],s.bitmap.data[o+1]=this.bitmap.data[n+1],s.bitmap.data[o+2]=this.bitmap.data[n+2],s.bitmap.data[o+3]=this.bitmap.data[n+3]}),isNodePattern(o)?o.call(this,null,this):this},Jimp.prototype.mask=function(t,i,a,r){if("object"!=typeof t||t.constructor!=Jimp)return throwError.call(this,"The source must be a Jimp image",r);if("number"!=typeof i||"number"!=typeof a)return throwError.call(this,"x and y must be numbers",r);i=Math.round(i),a=Math.round(a);var e=this;return t.scan(0,0,t.bitmap.width,t.bitmap.height,function(t,r,h){var n=e.getPixelIndex(i+t,a+r),o=(this.bitmap.data[h+0]+this.bitmap.data[h+1]+this.bitmap.data[h+2])/3;e.bitmap.data[n+3]*=o/255}),isNodePattern(r)?r.call(this,null,this):this},Jimp.prototype.composite=function(t,i,a,r){if("object"!=typeof t||t.constructor!=Jimp)return throwError.call(this,"The source must be a Jimp image",r);if("number"!=typeof i||"number"!=typeof a)return throwError.call(this,"x and y must be numbers",r);i=Math.round(i),a=Math.round(a);var e=this;return t.scan(0,0,t.bitmap.width,t.bitmap.height,function(t,r,h){var n=e.getPixelIndex(i+t,a+r),o={r:this.bitmap.data[h+0]/255,g:this.bitmap.data[h+1]/255,b:this.bitmap.data[h+2]/255,a:this.bitmap.data[h+3]/255},s={r:e.bitmap.data[n+0]/255,g:e.bitmap.data[n+1]/255,b:e.bitmap.data[n+2]/255,a:e.bitmap.data[n+3]/255},p=s.a+o.a-s.a*o.a,m=(o.r*o.a+s.r*s.a*(1-o.a))/p,u=(o.g*o.a+s.g*s.a*(1-o.a))/p,l=(o.b*o.a+s.b*s.a*(1-o.a))/p;e.bitmap.data[n+0]=Jimp.limit255(255*m),e.bitmap.data[n+1]=Jimp.limit255(255*u),e.bitmap.data[n+2]=Jimp.limit255(255*l),e.bitmap.data[n+3]=Jimp.limit255(255*p)}),isNodePattern(r)?r.call(this,null,this):this},Jimp.prototype.brightness=function(t,i){return"number"!=typeof t?throwError.call(this,"val must be numbers",i):t<-1||t>1?throwError.call(this,"val must be a number between -1 and +1",i):(this.scan(0,0,this.bitmap.width,this.bitmap.height,function(i,a,r){t<0?(this.bitmap.data[r]=this.bitmap.data[r]*(1+t),this.bitmap.data[r+1]=this.bitmap.data[r+1]*(1+t),this.bitmap.data[r+2]=this.bitmap.data[r+2]*(1+t)):(this.bitmap.data[r]=this.bitmap.data[r]+(255-this.bitmap.data[r])*t,this.bitmap.data[r+1]=this.bitmap.data[r+1]+(255-this.bitmap.data[r+1])*t,this.bitmap.data[r+2]=this.bitmap.data[r+2]+(255-this.bitmap.data[r+2])*t)}),isNodePattern(i)?i.call(this,null,this):this)},Jimp.prototype.contrast=function(t,i){function a(i){if(t<0)return(a=i>127?1-i/255:i/255)<0&&(a=0),a=.5*Math.pow(2*a,1+t),i>127?255*(1-a):255*a;var a=i>127?1-i/255:i/255;return a<0&&(a=0),a=.5*Math.pow(2*a,1==t?127:1/(1-t)),i>127?255*(1-a):255*a}return"number"!=typeof t?throwError.call(this,"val must be numbers",i):t<-1||t>1?throwError.call(this,"val must be a number between -1 and +1",i):(this.scan(0,0,this.bitmap.width,this.bitmap.height,function(t,i,r){this.bitmap.data[r]=a(this.bitmap.data[r]),this.bitmap.data[r+1]=a(this.bitmap.data[r+1]),this.bitmap.data[r+2]=a(this.bitmap.data[r+2])}),isNodePattern(i)?i.call(this,null,this):this)},Jimp.prototype.posterize=function(t,i){return"number"!=typeof t?throwError.call(this,"n must be numbers",i):(t<2&&(t=2),this.scan(0,0,this.bitmap.width,this.bitmap.height,function(i,a,r){this.bitmap.data[r]=Math.floor(this.bitmap.data[r]/255*(t-1))/(t-1)*255,this.bitmap.data[r+1]=Math.floor(this.bitmap.data[r+1]/255*(t-1))/(t-1)*255,this.bitmap.data[r+2]=Math.floor(this.bitmap.data[r+2]/255*(t-1))/(t-1)*255}),isNodePattern(i)?i.call(this,null,this):this)},Jimp.prototype.normalize=function(t){var i=histogram.call(this),a=function(t,i,a){return 255*(t-i)/(a-i)},r=function(t){return[t.findIndex(function(t){return t>0}),255-t.slice().reverse().findIndex(function(t){return t>0})]},e={r:r(i.r),g:r(i.g),b:r(i.b)};return this.scan(0,0,this.bitmap.width,this.bitmap.height,function(t,i,r){var h=this.bitmap.data[r+0],n=this.bitmap.data[r+1],o=this.bitmap.data[r+2];this.bitmap.data[r+0]=a(h,e.r[0],e.r[1]),this.bitmap.data[r+1]=a(n,e.g[0],e.g[1]),this.bitmap.data[r+2]=a(o,e.b[0],e.b[1])}),isNodePattern(t)?t.call(this,null,this):this},Jimp.prototype.invert=function(t){return this.scan(0,0,this.bitmap.width,this.bitmap.height,function(t,i,a){this.bitmap.data[a]=255-this.bitmap.data[a],this.bitmap.data[a+1]=255-this.bitmap.data[a+1],this.bitmap.data[a+2]=255-this.bitmap.data[a+2]}),isNodePattern(t)?t.call(this,null,this):this},Jimp.prototype.mirror=Jimp.prototype.flip=function(t,i,a){if("boolean"!=typeof t||"boolean"!=typeof i)return throwError.call(this,"horizontal and vertical must be Booleans",a);var r=new Buffer(this.bitmap.data.length);return this.scan(0,0,this.bitmap.width,this.bitmap.height,function(a,e,h){var n=t?this.bitmap.width-1-a:a,o=i?this.bitmap.height-1-e:e,s=this.bitmap.width*o+n<<2,p=this.bitmap.data.readUInt32BE(h,!0);r.writeUInt32BE(p,s,!0)}),this.bitmap.data=new Buffer(r),isNodePattern(a)?a.call(this,null,this):this},Jimp.prototype.gaussian=function(t,i){if("number"!=typeof t)return throwError.call(this,"r must be a number",i);if(t<1)return throwError.call(this,"r must be greater than 0",i);for(var a=Math.ceil(2.57*t),r=0;r<this.bitmap.height;r++){log("Gaussian: "+Math.round(r/this.bitmap.height*100)+"%");for(var e=0;e<this.bitmap.width;e++)for(var h=0,n=0,o=0,s=0,p=0,m=r-a;m<r+a+1;m++){for(var u=e-a;u<e+a+1;u++){var l=Math.min(this.bitmap.width-1,Math.max(0,u)),b=Math.min(this.bitmap.height-1,Math.max(0,m)),f=(u-e)*(u-e)+(m-r)*(m-r),c=Math.exp(-f/(2*t*t))/(2*Math.PI*t*t),d=b*this.bitmap.width+l<<2;h+=this.bitmap.data[d]*c,n+=this.bitmap.data[d+1]*c,o+=this.bitmap.data[d+2]*c,s+=this.bitmap.data[d+3]*c,p+=c}d=r*this.bitmap.width+e<<2;this.bitmap.data[d]=Math.round(h/p),this.bitmap.data[d+1]=Math.round(n/p),this.bitmap.data[d+2]=Math.round(o/p),this.bitmap.data[d+3]=Math.round(s/p)}}return clear(),isNodePattern(i)?i.call(this,null,this):this};var mul_table=[1,57,41,21,203,34,97,73,227,91,149,62,105,45,39,137,241,107,3,173,39,71,65,238,219,101,187,87,81,151,141,133,249,117,221,209,197,187,177,169,5,153,73,139,133,127,243,233,223,107,103,99,191,23,177,171,165,159,77,149,9,139,135,131,253,245,119,231,224,109,211,103,25,195,189,23,45,175,171,83,81,79,155,151,147,9,141,137,67,131,129,251,123,30,235,115,113,221,217,53,13,51,50,49,193,189,185,91,179,175,43,169,83,163,5,79,155,19,75,147,145,143,35,69,17,67,33,65,255,251,247,243,239,59,29,229,113,111,219,27,213,105,207,51,201,199,49,193,191,47,93,183,181,179,11,87,43,85,167,165,163,161,159,157,155,77,19,75,37,73,145,143,141,35,138,137,135,67,33,131,129,255,63,250,247,61,121,239,237,117,29,229,227,225,111,55,109,216,213,211,209,207,205,203,201,199,197,195,193,48,190,47,93,185,183,181,179,178,176,175,173,171,85,21,167,165,41,163,161,5,79,157,78,154,153,19,75,149,74,147,73,144,143,71,141,140,139,137,17,135,134,133,66,131,65,129,1],shg_table=[0,9,10,10,14,12,14,14,16,15,16,15,16,15,15,17,18,17,12,18,16,17,17,19,19,18,19,18,18,19,19,19,20,19,20,20,20,20,20,20,15,20,19,20,20,20,21,21,21,20,20,20,21,18,21,21,21,21,20,21,17,21,21,21,22,22,21,22,22,21,22,21,19,22,22,19,20,22,22,21,21,21,22,22,22,18,22,22,21,22,22,23,22,20,23,22,22,23,23,21,19,21,21,21,23,23,23,22,23,23,21,23,22,23,18,22,23,20,22,23,23,23,21,22,20,22,21,22,24,24,24,24,24,22,21,24,23,23,24,21,24,23,24,22,24,24,22,24,24,22,23,24,24,24,20,23,22,23,24,24,24,24,24,24,24,23,21,23,22,23,24,24,24,22,24,24,24,23,22,24,24,25,23,25,25,23,24,25,25,24,22,25,25,25,24,23,24,25,25,25,25,25,25,25,25,25,25,25,25,23,25,23,24,25,25,25,25,25,25,25,25,25,24,22,25,25,23,25,25,20,24,25,24,25,25,22,24,25,24,25,24,25,25,24,25,25,25,25,22,25,25,25,24,25,24,25,18];Jimp.prototype.blur=function(t,i){if("number"!=typeof t)return throwError.call(this,"r must be a number",i);if(t<1)return throwError.call(this,"r must be greater than 0",i);for(var a,r,e,h,n,o,s,p,m,u,l,b,f,c,d=this.bitmap.width-1,g=this.bitmap.height-1,w=(this.bitmap.width,this.bitmap.height,t+1),y=mul_table[t],E=shg_table[t],M=[],v=[],J=[],P=[],I=[],_=[],x=2;x-- >0;){for(f=b=0,o=0;o<this.bitmap.height;o++){for(a=this.bitmap.data[f]*w,r=this.bitmap.data[f+1]*w,e=this.bitmap.data[f+2]*w,h=this.bitmap.data[f+3]*w,s=1;s<=t;s++)p=f+((s>d?d:s)<<2),a+=this.bitmap.data[p++],r+=this.bitmap.data[p++],e+=this.bitmap.data[p++],h+=this.bitmap.data[p];for(n=0;n<this.bitmap.width;n++)M[b]=a,v[b]=r,J[b]=e,P[b]=h,0==o&&(I[n]=((p=n+w)<d?p:d)<<2,_[n]=(p=n-t)>0?p<<2:0),m=f+I[n],u=f+_[n],a+=this.bitmap.data[m++]-this.bitmap.data[u++],r+=this.bitmap.data[m++]-this.bitmap.data[u++],e+=this.bitmap.data[m++]-this.bitmap.data[u++],h+=this.bitmap.data[m]-this.bitmap.data[u],b++;f+=this.bitmap.width<<2}for(n=0;n<this.bitmap.width;n++){for(a=M[l=n]*w,r=v[l]*w,e=J[l]*w,h=P[l]*w,s=1;s<=t;s++)a+=M[l+=s>g?0:this.bitmap.width],r+=v[l],e+=J[l],h+=P[l];for(b=n<<2,o=0;o<this.bitmap.height;o++)this.bitmap.data[b+3]=c=h*y>>>E,c>255&&(this.bitmap.data[b+3]=255),c>0?(c=255/c,this.bitmap.data[b]=(a*y>>>E)*c,this.bitmap.data[b+1]=(r*y>>>E)*c,this.bitmap.data[b+2]=(e*y>>>E)*c):this.bitmap.data[b]=this.bitmap.data[b+1]=this.bitmap.data[b+2]=0,0==n&&(I[o]=((p=o+w)<g?p:g)*this.bitmap.width,_[o]=(p=o-t)>0?p*this.bitmap.width:0),m=n+I[o],u=n+_[o],a+=M[m]-M[u],r+=v[m]-v[u],e+=J[m]-J[u],h+=P[m]-P[u],b+=this.bitmap.width<<2}}return isNodePattern(i)?i.call(this,null,this):this},Jimp.prototype.convolution=function(t,i,a){"function"==typeof i&&void 0===a&&(a=i,i=null),i||(i=Jimp.EDGE_EXTEND);var r,e,h,n,o,s,p,m,u,l,b=new Buffer(this.bitmap.data),f=t.length,c=t[0].length,d=Math.floor(f/2),g=Math.floor(c/2),w=-d,y=-g;return this.scan(0,0,this.bitmap.width,this.bitmap.height,function(a,f,c){for(e=h=n=0,row=w;row<=d;row++)for(col=y;col<=g;col++)m=a+col,u=f+row,r=t[row+d][col+g],-1==(l=this.getPixelIndex(m,u,i))?o=s=p=0:(o=this.bitmap.data[l+0],s=this.bitmap.data[l+1],p=this.bitmap.data[l+2]),e+=r*o,h+=r*s,n+=r*p;e<0&&(e=0),h<0&&(h=0),n<0&&(n=0),e>255&&(e=255),h>255&&(h=255),n>255&&(n=255),b[c+0]=e,b[c+1]=h,b[c+2]=n}),this.bitmap.data=b,isNodePattern(a)?a.call(this,null,this):this},Jimp.prototype.greyscale=function(t){return this.scan(0,0,this.bitmap.width,this.bitmap.height,function(t,i,a){var r=parseInt(.2126*this.bitmap.data[a]+.7152*this.bitmap.data[a+1]+.0722*this.bitmap.data[a+2],10);this.bitmap.data[a]=r,this.bitmap.data[a+1]=r,this.bitmap.data[a+2]=r}),isNodePattern(t)?t.call(this,null,this):this},Jimp.prototype.grayscale=Jimp.prototype.greyscale,Jimp.prototype.sepia=function(t){return this.scan(0,0,this.bitmap.width,this.bitmap.height,function(t,i,a){var r=this.bitmap.data[a],e=this.bitmap.data[a+1],h=this.bitmap.data[a+2];h=.272*(r=.393*r+.769*e+.189*h)+.534*(e=.349*r+.686*e+.168*h)+.131*h,this.bitmap.data[a]=r<255?r:255,this.bitmap.data[a+1]=e<255?e:255,this.bitmap.data[a+2]=h<255?h:255}),isNodePattern(t)?t.call(this,null,this):this},Jimp.prototype.opacity=function(t,i){return"number"!=typeof t?throwError.call(this,"f must be a number",i):t<0||t>1?throwError.call(this,"f must be a number from 0 to 1",i):(this.scan(0,0,this.bitmap.width,this.bitmap.height,function(i,a,r){var e=this.bitmap.data[r+3]*t;this.bitmap.data[r+3]=e}),isNodePattern(i)?i.call(this,null,this):this)},Jimp.prototype.fade=function(t,i){return"number"!=typeof t?throwError.call(this,"f must be a number",i):t<0||t>1?throwError.call(this,"f must be a number from 0 to 1",i):(this.opacity(1-t),isNodePattern(i)?i.call(this,null,this):this)},Jimp.prototype.opaque=function(t){return this.scan(0,0,this.bitmap.width,this.bitmap.height,function(t,i,a){this.bitmap.data[a+3]=255}),isNodePattern(t)?t.call(this,null,this):this},Jimp.prototype.resize=function(t,i,a,r){if("number"!=typeof t||"number"!=typeof i)return throwError.call(this,"w and h must be numbers",r);if("function"==typeof a&&void 0===r&&(r=a,a=null),t==Jimp.AUTO&&i==Jimp.AUTO)return throwError.call(this,"w and h cannot both the set to auto",r);if(t==Jimp.AUTO&&(t=this.bitmap.width*(i/this.bitmap.height)),i==Jimp.AUTO&&(i=this.bitmap.height*(t/this.bitmap.width)),t=Math.round(t),i=Math.round(i),"function"==typeof Resize2[a]){var e={data:new Buffer(t*i*4),width:t,height:i};Resize2[a](this.bitmap,e),this.bitmap=e}else{var h=this;new Resize(this.bitmap.width,this.bitmap.height,t,i,!0,!0,function(a){h.bitmap.data=new Buffer(a),h.bitmap.width=t,h.bitmap.height=i}).resize(this.bitmap.data)}return isNodePattern(r)?r.call(this,null,this):this},Jimp.prototype.cover=function(t,i,a,r,e){if("number"!=typeof t||"number"!=typeof i)return throwError.call(this,"w and h must be numbers",e);a&&"function"==typeof a&&void 0===e?(e=a,a=null,r=null):"function"==typeof r&&void 0===e&&(e=r,r=null);var h=7&(a=a||Jimp.HORIZONTAL_ALIGN_CENTER|Jimp.VERTICAL_ALIGN_MIDDLE),n=a>>3;if((0==h||h&h-1)&&(0==n||n&n-1))return throwError.call(this,"only use one flag per alignment direction",e);var o=h>>1,s=n>>1,p=t/i>this.bitmap.width/this.bitmap.height?t/this.bitmap.width:i/this.bitmap.height;return this.scale(p,r),this.crop((this.bitmap.width-t)/2*o,(this.bitmap.height-i)/2*s,t,i),isNodePattern(e)?e.call(this,null,this):this},Jimp.prototype.contain=function(t,i,a,r,e){if("number"!=typeof t||"number"!=typeof i)return throwError.call(this,"w and h must be numbers",e);switch(typeof a){case"string":"function"==typeof r&&void 0===e&&(e=r),r=a,a=null;case"function":void 0===e&&(e=a),r=null,a=null;default:"function"==typeof r&&void 0===e&&(e=r,r=null)}var h=7&(a=a||Jimp.HORIZONTAL_ALIGN_CENTER|Jimp.VERTICAL_ALIGN_MIDDLE),n=a>>3;if((0==h||h&h-1)&&(0==n||n&n-1))return throwError.call(this,"only use one flag per alignment direction",e);var o=h>>1,s=n>>1,p=t/i>this.bitmap.width/this.bitmap.height?i/this.bitmap.height:t/this.bitmap.width,m=this.clone().scale(p,r);return this.resize(t,i,r),this.scan(0,0,this.bitmap.width,this.bitmap.height,function(t,i,a){this.bitmap.data.writeUInt32BE(this._background,a)}),this.blit(m,(this.bitmap.width-m.bitmap.width)/2*o,(this.bitmap.height-m.bitmap.height)/2*s),isNodePattern(e)?e.call(this,null,this):this},Jimp.prototype.scale=function(t,i,a){if("number"!=typeof t)return throwError.call(this,"f must be a number",a);if(t<0)return throwError.call(this,"f must be a positive number",a);"function"==typeof i&&void 0===a&&(a=i,i=null);var r=this.bitmap.width*t,e=this.bitmap.height*t;return this.resize(r,e,i),isNodePattern(a)?a.call(this,null,this):this},Jimp.prototype.scaleToFit=function(t,i,a,r){if("number"!=typeof t||"number"!=typeof i)return throwError.call(this,"w and h must be numbers",r);"function"==typeof a&&void 0===r&&(r=a,a=null);var e=t/i>this.bitmap.width/this.bitmap.height?i/this.bitmap.height:t/this.bitmap.width;return this.scale(e,a),isNodePattern(r)?r.call(this,null,this):this},Jimp.prototype.rotate=function(t,i,a){return void 0!==i&&null!==i||(i=!0),"function"==typeof i&&void 0===a&&(a=i,i=!0),"number"!=typeof t?throwError.call(this,"deg must be a number",a):"boolean"!=typeof i&&"string"!=typeof i?throwError.call(this,"mode must be a boolean or a string",a):(t%90==0&&!1!==i?simpleRotate.call(this,t,a):advancedRotate.call(this,t,i,a),isNodePattern(a)?a.call(this,null,this):this)},Jimp.prototype.getBuffer=function(t,i){if(t==Jimp.AUTO&&(t=this.getMIME()),"string"!=typeof t)return throwError.call(this,"mime must be a string",i);if("function"!=typeof i)return throwError.call(this,"cb must be a function",i);switch(t.toLowerCase()){case Jimp.MIME_PNG:var a=this,r=new PNG({width:this.bitmap.width,height:this.bitmap.height,bitDepth:8,deflateLevel:this._deflateLevel,deflateStrategy:this._deflateStrategy,filterType:this._filterType,colorType:this._rgba?6:2,inputHasAlpha:!0});this._rgba?r.data=new Buffer(this.bitmap.data):r.data=compositeBitmapOverBackground(this).data,StreamToBuffer(r.pack(),function(t,r){return i.call(a,null,r)});break;case Jimp.MIME_JPEG:var e=JPEG.encode(compositeBitmapOverBackground(this),this._quality);return i.call(this,null,e.data);case Jimp.MIME_BMP:var h=BMP.encode(compositeBitmapOverBackground(this));return i.call(this,null,h.data);default:return i.call(this,"Unsupported MIME type: "+t)}return this},Jimp.prototype.getBase64=function(t,i){return t==Jimp.AUTO&&(t=this.getMIME()),"string"!=typeof t?throwError.call(this,"mime must be a string",i):"function"!=typeof i?throwError.call(this,"cb must be a function",i):(this.getBuffer(t,function(a,r){var e="data:"+t+";base64,"+r.toString("base64");return i.call(this,null,e)}),this)},Jimp.prototype.dither565=function(t){var i=[1,9,3,11,13,5,15,7,4,12,2,10,16,8,14,6];return this.scan(0,0,this.bitmap.width,this.bitmap.height,function(t,a,r){var e=i[((3&a)<<2)+t%4];this.bitmap.data[r]=Math.min(this.bitmap.data[r]+e,255),this.bitmap.data[r+1]=Math.min(this.bitmap.data[r+1]+e,255),this.bitmap.data[r+2]=Math.min(this.bitmap.data[r+2]+e,255)}),isNodePattern(t)?t.call(this,null,this):this},Jimp.prototype.dither16=Jimp.prototype.dither565,Jimp.prototype.color=Jimp.prototype.colour=function(t,i){if(!t||!Array.isArray(t))return throwError.call(this,"actions must be an array",i);var a=this;return this.scan(0,0,this.bitmap.width,this.bitmap.height,function(r,e,h){var n=TinyColor({r:this.bitmap.data[h],g:this.bitmap.data[h+1],b:this.bitmap.data[h+2]}),o=function(t,i){return c=n.toRgb(),c[t]=Math.max(0,Math.min(c[t]+i,255)),TinyColor(c)};t.forEach(function(t){if("mix"===t.apply)n=TinyColor.mix(n,t.params[0],t.params[1]);else if("tint"===t.apply)n=TinyColor.mix(n,"white",t.params[0]);else if("shade"===t.apply)n=TinyColor.mix(n,"black",t.params[0]);else if("xor"===t.apply){var r=TinyColor(t.params[0]).toRgb();n=n.toRgb(),n=TinyColor({r:n.r^r.r,g:n.g^r.g,b:n.b^r.b})}else if("red"===t.apply)n=o("r",t.params[0]);else if("green"===t.apply)n=o("g",t.params[0]);else if("blue"===t.apply)n=o("b",t.params[0]);else{"hue"===t.apply&&(t.apply="spin");var e=n[t.apply];if(!e)return throwError.call(a,"action "+t.apply+" not supported",i);n=e.apply(n,t.params)}}),n=n.toRgb(),this.bitmap.data[h]=n.r,this.bitmap.data[h+1]=n.g,this.bitmap.data[h+2]=n.b}),isNodePattern(i)?i.call(this,null,this):this},Jimp.loadFont=function(t,i){if("string"!=typeof t)return throwError.call(this,"file must be a string",i);var a=this;return new Promise(function(r,e){i=i||function(t,i){t?e(t):r(i)},BMFont(t,function(r,e){var h={},n={};if(r)return throwError.call(a,r,i);for(o=0;o<e.chars.length;o++)h[String.fromCharCode(e.chars[o].id)]=e.chars[o];for(var o=0;o<e.kernings.length;o++){var s=String.fromCharCode(e.kernings[o].first);n[s]=n[s]||{},n[s][String.fromCharCode(e.kernings[o].second)]=e.kernings[o].amount}loadPages(Path.dirname(t),e.pages).then(function(t){i(null,{chars:h,kernings:n,pages:t,common:e.common,info:e.info})})})})},Jimp.prototype.print=function(t,i,a,r,e,h){if("function"==typeof e&&void 0===h&&(h=e,e=1/0),void 0===e&&(e=1/0),"object"!=typeof t)return throwError.call(this,"font must be a Jimp loadFont",h);if("number"!=typeof i||"number"!=typeof a||"number"!=typeof e)return throwError.call(this,"x, y and maxWidth must be numbers",h);if("string"!=typeof r)return throwError.call(this,"text must be a string",h);if("number"!=typeof e)return throwError.call(this,"maxWidth must be a number",h);for(var n=this,o=r.split(" "),s="",p=0;p<o.length;p++){var m=s+o[p]+" ";measureText(t,m)>e&&p>0?(n=n.print(t,i,a,s),s=o[p]+" ",a+=t.common.lineHeight):s=m}return printText.call(this,t,i,a,s),isNodePattern(h)?h.call(this,null,n):n},Jimp.prototype.write=function(t,i){if("string"!=typeof t)return throwError.call(this,"path must be a string",i);if(void 0===i&&(i=function(){}),"function"!=typeof i)return throwError.call(this,"cb must be a function",i);var a=this,r=MIME.lookup(t);return this.getBuffer(r,function(r,e){if(r)return throwError.call(a,r,i);var h=FS.createWriteStream(t);h.on("open",function(t){h.write(e),h.end()}).on("error",function(t){return throwError.call(a,t,i)}),h.on("finish",function(t){return i.call(a,null,a)})}),this},function(){function t(t,i){var a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType="arraybuffer",a.onload=function(){a.status<400?i(this.response,null):i(null,"HTTP Status "+a.status+" for url "+t)},a.onerror=function(t){i(null,t)},a.send()}function i(t){for(var i=new Buffer(t.byteLength),a=new Uint8Array(t),r=0;r<i.length;++r)i[r]=a[r];return i}function a(t){return Object.prototype.toString.call(t).toLowerCase().indexOf("arraybuffer")>-1}delete Jimp.prototype.write,delete Jimp.read,Jimp.read=function(r,e){return new Promise(function(h,n){e=e||function(t,i){t?n(t):h(i)},"string"==typeof r?t(r,function(t,h){t?a(t)?new Jimp(i(t),e):e(new Error("Unrecognized data received for "+r)):h&&e(h)}):a(r)?new Jimp(i(r),e):e(new Error("Jimp expects a single ArrayBuffer or image URL"))})}}(),module.exports=Jimp;
//# sourceMappingURL=/sm/2fdc83d93e1314635baf08a254f03a5e9a275e5aa717b89f55c7d48764aeacb0.map